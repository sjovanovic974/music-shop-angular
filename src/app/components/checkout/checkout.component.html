<div class="container mt-5">
  <form [formGroup]="checkoutFormGroup" (ngSubmit)="onSubmit()">
    <!-- customer form group -->
    <div formGroupName="customer">
      <h3>Customer</h3>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">First Name</label>
        </div>
        <div class="col-md-9">
          <div>
            <input
              formControlName="firstName"
              type="text"
              class="form-control"
            />

            <div
              *ngIf="
                firstName?.invalid && (firstName?.dirty || firstName?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (firstName?.errors)!['required'] ||
                  (firstName?.errors)!['notOnlyWhiteSpace']
                "
              >
                First Name is required
              </div>

              <div *ngIf="(firstName?.errors)!['minlength']">
                First Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Last Name</label>
        </div>
        <div class="col-md-9">
          <div>
            <input
              formControlName="lastName"
              type="text"
              class="form-control"
            />

            <div
              *ngIf="
                lastName?.invalid && (lastName?.dirty || lastName?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (lastName?.errors)!['required'] ||
                  (lastName?.errors)!['notOnlyWhiteSpace']
                "
              >
                Last Name is required
              </div>

              <div *ngIf="(lastName?.errors)!['minlength']">
                Last Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Email</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="email" type="text" class="form-control" />

            <div
              *ngIf="email?.invalid && (email?.dirty || email?.touched)"
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(email?.errors)!['required']">Email is required</div>

              <div *ngIf="(email?.errors)!['pattern']">
                Email must be a valid email address format
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- shipping address form group -->
    <div formGroupName="shippingAddress" class="mt-5">
      <h3>Shipping Address</h3>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Country</label>
        </div>
        <div class="col-md-9">
          <div>
            <select
              formControlName="country"
              (change)="getStates('shippingAddress')"
            >
              <option *ngFor="let country of countries" [ngValue]="country">
                {{ country.name }}
              </option>
            </select>

            <div
              *ngIf="
                shippingAddressCountry?.invalid &&
                (shippingAddressCountry?.dirty ||
                  shippingAddressCountry?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(shippingAddressCountry?.errors)!['required']">
                Country is required
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Street</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="street" type="text" class="form-control" />

            <div
              *ngIf="
                shippingAddressStreet?.invalid &&
                (shippingAddressStreet?.dirty || shippingAddressStreet?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (shippingAddressStreet?.errors)!['required'] ||
                  (shippingAddressStreet?.errors)!['notOnlyWhiteSpace']
                "
              >
                Street is required
              </div>

              <div *ngIf="(shippingAddressStreet?.errors)!['minlength']">
                Street Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">City</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="city" type="text" class="form-control" />

            <div
              *ngIf="
                shippingAddressCity?.invalid &&
                (shippingAddressCity?.dirty || shippingAddressCity?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (shippingAddressCity?.errors)!['required'] ||
                  (shippingAddressCity?.errors)!['notOnlyWhiteSpace']
                "
              >
                City is required
              </div>

              <div *ngIf="(shippingAddressCity?.errors)!['minlength']">
                City Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">State</label>
        </div>
        <div class="col-md-9">
          <div>
            <select formControlName="state">
              <option
                *ngFor="let state of shippingAddressStates"
                [ngValue]="state"
              >
                {{ state.name }}
              </option>
            </select>

            <div
              *ngIf="
                shippingAddressState?.invalid &&
                (shippingAddressState?.dirty || shippingAddressState?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(shippingAddressState?.errors)!['required']">
                State is required
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Zip Code</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="zipCode" type="text" class="form-control" />

            <div
              *ngIf="
                shippingAddressZipCode?.invalid &&
                (shippingAddressZipCode?.dirty ||
                  shippingAddressZipCode?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(shippingAddressZipCode?.errors)!['required']">
                Zip Code is required
              </div>

              <div *ngIf="(shippingAddressZipCode?.errors)!['pattern']">
                Zip Code must be a number of 5 digits (e.g. 75000)
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add check Box to copy shipping address to billing address -->
    <div class="mt-3 mb-3">
      <label class="au-checkbox">
        <input
          type="checkbox"
          (change)="copyShippingAddressToBillingAddress($event)"
        />
        <span class="au-checkmark">
          Billing Address same as Shipping Address</span
        >
      </label>
    </div>

    <!-- billing address form group-->
    <div formGroupName="billingAddress" class="mt-5">
      <h3>Billing Address</h3>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Country</label>
        </div>
        <div class="col-md-9">
          <div>
            <select
              formControlName="country"
              (change)="getStates('billingAddress')"
            >
              <option *ngFor="let country of countries" [ngValue]="country">
                {{ country.name }}
              </option>
            </select>

            <div
              *ngIf="
                billingAddressCountry?.invalid &&
                (billingAddressCountry?.dirty || billingAddressCountry?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(billingAddressCountry?.errors)!['required']">
                Country is required
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Street</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="street" type="text" class="form-control" />

            <div
              *ngIf="
                billingAddressStreet?.invalid &&
                (billingAddressStreet?.dirty || billingAddressStreet?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (billingAddressStreet?.errors)!['required'] ||
                  (billingAddressStreet?.errors)!['notOnlyWhiteSpace']
                "
              >
                Street is required
              </div>

              <div *ngIf="(billingAddressStreet?.errors)!['minlength']">
                Street Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">City</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="city" type="text" class="form-control" />

            <div
              *ngIf="
                billingAddressCity?.invalid &&
                (billingAddressCity?.dirty || billingAddressCity?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (billingAddressCity?.errors)!['required'] ||
                  (billingAddressCity?.errors)!['notOnlyWhiteSpace']
                "
              >
                City is required
              </div>

              <div *ngIf="(billingAddressCity?.errors)!['minlength']">
                City Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">State</label>
        </div>
        <div class="col-md-9">
          <div>
            <select formControlName="state">
              <option
                *ngFor="let state of billingAddressStates"
                [ngValue]="state"
              >
                {{ state.name }}
              </option>
            </select>

            <div
              *ngIf="
                billingAddressState?.invalid &&
                (billingAddressState?.dirty || billingAddressState?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(billingAddressState?.errors)!['required']">
                State is required
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Zip Code</label>
        </div>
        <div class="col-md-9">
          <div>
            <input formControlName="zipCode" type="text" class="form-control" />

            <div
              *ngIf="
                billingAddressZipCode?.invalid &&
                (billingAddressZipCode?.dirty || billingAddressZipCode?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(billingAddressZipCode?.errors)!['required']">
                Zip Code is required
              </div>

              <div *ngIf="(billingAddressZipCode?.errors)!['pattern']">
                Zip Code must be a number of 5 digits (e.g. 75000)
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Credit Card -->
    <div formGroupName="creditCard" class="mt-5">
      <h3>Credit Card</h3>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Card Type</label>
        </div>
        <div class="col-md-9">
          <div>
            <select formControlName="cardType">
              <option>Visa</option>
              <option>Mastercard</option>
            </select>

            <div
              *ngIf="
                creditCardType?.invalid &&
                (creditCardType?.dirty || creditCardType?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(creditCardType?.errors)!['required']">
                Credit Card type is required
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Name on Card</label>
        </div>
        <div class="col-md-9">
          <div>
            <input
              formControlName="nameOnCard"
              type="text"
              class="form-control"
            />

            <div
              *ngIf="
                creditCardNameOnCard?.invalid &&
                (creditCardNameOnCard?.dirty || creditCardNameOnCard?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div
                *ngIf="
                  (creditCardNameOnCard?.errors)!['required'] ||
                  (creditCardNameOnCard?.errors)!['notOnlyWhiteSpace']
                "
              >
                Name on card is required
              </div>

              <div *ngIf="(creditCardNameOnCard?.errors)!['minlength']">
                Name must be at least 2 characters long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Card Number</label>
        </div>
        <div class="col-md-9">
          <div>
            <input
              formControlName="cardNumber"
              type="text"
              class="form-control"
            />

            <div
              *ngIf="
                creditCardNumber?.invalid &&
                (creditCardNumber?.dirty || creditCardNumber?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(creditCardNumber?.errors)!['required']">
                Card number is required
              </div>

              <div *ngIf="(creditCardNumber?.errors)!['pattern']">
                Card number must be 16 digits long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Security Code</label>
        </div>
        <div class="col-md-9">
          <div>
            <input
              formControlName="securityCode"
              type="text"
              class="form-control"
            />

            <div
              *ngIf="
                creditCardSecurityCode?.invalid &&
                (creditCardSecurityCode?.dirty ||
                  creditCardSecurityCode?.touched)
              "
              class="aler alert-danger mt-1"
            >
              <div *ngIf="(creditCardSecurityCode?.errors)!['required']">
                Security number is required
              </div>

              <div *ngIf="(creditCardSecurityCode?.errors)!['pattern']">
                Security number must be 3 digits long
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Expiration Month</label>
        </div>
        <div class="col-md-9">
          <div>
            <select formControlName="expirationMonth">
              <option *ngFor="let month of creditCardMonths">
                {{ month }}
              </option>
            </select>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-2">
          <label class="col-form-label">Expiration Year</label>
        </div>
        <div class="col-md-9">
          <div>
            <select
              formControlName="expirationYear"
              (change)="handleMonthsAndYears()"
            >
              <option *ngFor="let year of creditCardYears">{{ year }}</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Order details -->
    <div class="mt-5" style="font-weight: bold">
      <h3 class="mb-3">Review Your Order</h3>

      <p>Total Quantity: {{ totalQuantity }}</p>
      <p>Shipping: FREE</p>
      <p>Total Price: {{ totalPrice | currency: "USD" }}</p>
    </div>

    <!-- submit button -->
    <div class="mt-5 mb-5">
      <button type="submit" class="btn btn-info">Purchase</button>
    </div>
  </form>
</div>
